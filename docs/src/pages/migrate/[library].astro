---
import MappingFunctionCard from "@/components/mapping-function-card.astro";
import DocsPage from "@/layouts/docs-page.astro";
import { getMappingEntries, LIBRARIES } from "@/lib/mappings";
import { entries, flatMap, pipe, sortBy } from "remeda";

const { library } = Astro.params;

const mappingEntries = await getMappingEntries(library);

const forDisplay = pipe(
  mappingEntries,
  entries(),
  sortBy(([category]) => category),
  flatMap(([, functions]) => functions),
);

export const getStaticPaths = () =>
  LIBRARIES.map((library) => ({ params: { library } }));
---

<DocsPage categorized={mappingEntries}>
  {
    forDisplay.map(({ name }) => (
      <MappingFunctionCard name={name} library={library} />
    ))
  }
</DocsPage>
