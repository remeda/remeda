---
import Prose from "@/components/prose.astro";
import { getCollection, type CollectionEntry } from "astro:content";

const COLLECTION = "docs";

type Props = {
  readonly collectionQuery: (
    entry: CollectionEntry<typeof COLLECTION>,
  ) => boolean;
};

const { collectionQuery } = Astro.props;

const collection = await getCollection(COLLECTION, collectionQuery);
const renderedCollection = await Promise.all(
  collection.map(async (entry) => ({
    ...entry,
    rendered: await entry.render(),
  })),
);
---

{
  renderedCollection.map(({ slug, rendered: { Content } }) => (
    <Prose id={slug}>
      <Content />
    </Prose>
  ))
}
